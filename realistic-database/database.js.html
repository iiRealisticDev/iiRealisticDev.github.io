<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Adding favicon -->
    

    <!-- Adding meta -->
    
    
    <meta name="Author" content="iiRealistic_Dev" />
    
    <meta name="Description" value="A simple JSON-based database." />
    
    

    <!-- Adding external script-->
    

    <!-- Adding external style-->
    

    <!-- Adding scripts-->
    

    <!-- Adding style-->
    

    <!-- Adding overlay script-->
    

    <!-- Adding overlay style-->
    


    <title>
      database.js
    </title>

    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/third-party/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/third-party/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/reset.css">
    <link type="text/css" rel="stylesheet" href="styles/clean-jsdoc-theme-base.css">
    <link type="text/css" rel="stylesheet" href="styles/clean-jsdoc-theme-dark.css">
    
    <svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    style="display:none">
    <defs>
        <symbol id="copy-icon" viewbox="0 0 488.3 488.3">
            <g>
                <path
                    d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z" />
                <path
                    d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z" />
            </g>
        </symbol>
        <symbol id='search-icon' viewBox="0 0 512 512">
            <g>
                <g>
                    <path
                        d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z" />
                </g>
            </g>
            <g>
                <g>
                    <path
                        d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z" />
                </g>
            </g>
        </symbol>
        <symbol id="down-icon" viewBox="0 0 16 16">
            <path 
                fill-rule="evenodd" 
                clip-rule="evenodd" 
                d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"
            >
            </path>
        </symbol>
    </defs>
</svg>
  </head>

  <body>

    <nav class="navbar" id="navbar">
      <div class="navbar-heading" id="navbar-heading"><a href="index.html"><h2 class="navbar-heading-text">Home</h2></a></div><div class="search-box" id="search-box"><div class="search-box-input-container"><input class="search-box-input" type="text" placeholder="Search..." id="search-box-input" /><svg class="search-icon" alt="search-icon"><use xlink:href="#search-icon"></use></svg></div><div class="search-item-container" id="search-item-container"><ul class="search-item-ul" id="search-item-ul"></ul></div></div><div class="sidebar-main-content" id="sidebar-main-content"><ul><li class="menu-li"><a href='https://github.com/iiRealisticDev/realistic-database' class=' menu-link' id='github' target=''>GitHub Repo</a></li></ul><div class="accordion collapsed" id="5449728" > <h3 class="accordion-heading">Classes<svg><use xlink:href="#down-icon"></use></svg></h3><ul class="accordion-content"><li class="accordion-list" id=""><a href="DBFile.html">DBFile</a></li><li class="accordion collapsed child" id=3213953><div class="accordion-heading child"><a href="RealisticDatabase.html">RealisticDatabase</a><svg><use xlink:href="#down-icon"></use></svg></div><ul class='methods accordion-content'><li data-type='method'><a href="RealisticDatabase.html#get">get</a></li><li data-type='method'><a href="RealisticDatabase.html#put">put</a></li><li data-type='method'><a href="RealisticDatabase.html#read">read</a></li><li data-type='method'><a href="RealisticDatabase.html#remove">remove</a></li><li data-type='method'><a href="RealisticDatabase.html#save">save</a></li></ul></li></ul> </div><div class="accordion collapsed" id="5347848" > <h3 class="accordion-heading">Global<svg><use xlink:href="#down-icon"></use></svg></h3><ul class="accordion-content"><li class="accordion-list" id=""><a href="global.html#makeDir">makeDir</a></li><li class="accordion-list" id=""><a href="global.html#readDB">readDB</a></li><li class="accordion-list" id=""><a href="global.html#validatorFunc">validatorFunc</a></li><li class="accordion-list" id=""><a href="global.html#writeDB">writeDB</a></li></ul> </div>
      

    </nav>
    <div class="navbar-ham" id="navbar-ham">
      <div>
        <div class="first"></div>
        <div class="second"></div>
        <div class="third"></div>
      </div>
    </div>

    <div id="main" class="main-content">
      
      <h1 id='page-title' class="page-title">
        database.js
      </h1>
      

      



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.RealisticDatabase = void 0;
/* eslint-disable @typescript-eslint/no-explicit-any */
const utils_js_1 = require("./utils.js");
class RealisticDatabase {
    /**
     * @summary Create a database.
     * @description Creates a database at the given path, and presents the necessary methods to interact with it.
     * @param {string} dbDir A path to the directory the DB should be in.
     * @param {DBFile} dbFile A file where the DB should be stored. Must be JSON.
     * @example
     * const db = new RealisticDatabase("./db", new DBFile("db.json", "{}"));
     */
    constructor(dbDir, dbFile) {
        if (!(dbFile instanceof utils_js_1.DBFile))
            throw new Error("Database file must be a File.");
        if (!dbFile.name.endsWith(".json"))
            throw new Error("Database file must be JSON.");
        try {
            (0, utils_js_1.makeDir)(dbDir, dbFile);
        }
        catch (err) {
            throw new Error("Could not create database directory.\n\n" + err);
        }
        this.dbPath = `${dbDir}/${dbFile.name}`;
    }
    /**
     * @summary Returns the full database.
     * @description This is used to write to the database using [put](#put), and and return information using [get](#get).
     * @returns {Record&lt;string, unknown[]>} A JSON object representing the database.
     * @example
     * const db = db.read();
     */
    read() {
        return (0, utils_js_1.readDB)(this.dbPath);
    }
    /**
     * @summary Saves the new information to the file.
     * @description This is used interally with the [put](#put) method, however is usable otherwise if needed.
     * @param {Record&lt;string, unknown[]>} newJson The JSON to write to the file.
     * @example
     * db.save();
     */
    save(newJson) {
        (0, utils_js_1.writeDB)(this.dbPath, newJson);
    }
    /**
     * @summary Add a value to the database.
     * @description This adds a value to the database and automatically saves the changes.
     * @param {string} key The key to store it under.
     * @param {unknown} value The value to store.
     * @param {boolean} forceOverwrite A boolean indicating whether to overwrite the database entry if it already exists, `true` by default.
     * @example
     * // Put an entry into "people" with the name John and age 21
     * // But not if it already exists.
     * db.put("people", { name: "John", age: 21 }, false);
     */
    put(key, value, forceOverwrite = true) {
        if (typeof key !== "string")
            throw new Error("Key must be a string.");
        const db = this.read();
        if (db[key].includes(value) &amp;&amp; !forceOverwrite)
            throw new Error("Key already exists and forceOverwrite is disabled.");
        if (!db[key])
            db[key] = [];
        db[key].push(value);
        this.save(db);
    }
    /**
     * @summary Returns a value from the database.
     * @description This will return the value assigned to the key, or `null` if no value is assigned.
     * @param {string} key
     * @param {validatorFunc} validator
     * @returns The data assigned to the key or `null`.
     * @example
     * db.get("people", (value) => value.name === "John" &amp;&amp; value.age == 21);
     */
    get(key, validator) {
        const db = this.read();
        if (!db[key])
            return null;
        if (validator) {
            const valid = db[key].filter(validator);
            if (valid.length === 0)
                return null;
            return valid[0];
        }
    }
    /**
     * @summary Remove an entry from a database key.
     * @description This will remove the value from the database key, and automatically save the changes.
     * @param {string} key The key the value is under.
     * @param {validatorFunc} validator This will be used to determine the value to remove.
     * @returns True if removed, false if not.
     * @example
     * db.remove("people", (value) => value.name === "John");
     */
    remove(key, validator) {
        const db = this.read();
        if (!db[key])
            throw new Error(`Could not find ${key} in database.`);
        const valid = db[key].filter(validator);
        if (valid.length === 0)
            return false;
        db[key].splice(db[key].indexOf(valid[0]), 1);
        this.save(db);
        return true;
    }
}
exports.RealisticDatabase = RealisticDatabase;
exports.default = RealisticDatabase;
/**
 * @summary A validator for the key.
 * @description This will perform a check on the value and return whether or not the value meets the requirements.
 * @callback validatorFunc
 * @param {unknown} value The value to validate.
 * @returns {boolean} A boolean indicating whether the value is valid. True if valid, false if not.
 */
</code></pre>
        </article>
    </section>




    </div>

    <footer class="footer" id="footer">
      
    </footer>

    <script src="scripts/third-party/prettify.js"></script>
    <script src="scripts/third-party/lang-css.js"></script>
    <script type="text/javascript" src="scripts/misc.js"></script>

    <script>prettyPrint();</script>
    <script src="scripts/linenumber.js"></script>
    <script src="scripts/fix-code-block.js"></script>
    <script src="scripts/fix-navbar.js"></script>
    
      <script src="scripts/search.js"></script>
      <script src="scripts/third-party/fuse.js"></script>
      <script>
        var list = [{"title":"DBFile","link":"<a href=\"DBFile.html\">DBFile</a>"},{"title":"RealisticDatabase","link":"<a href=\"RealisticDatabase.html\">RealisticDatabase</a>"},{"title":"RealisticDatabase#get","link":"<a href=\"RealisticDatabase.html#get\">RealisticDatabase &rtrif; get</a>"},{"title":"RealisticDatabase#put","link":"<a href=\"RealisticDatabase.html#put\">RealisticDatabase &rtrif; put</a>"},{"title":"RealisticDatabase#read","link":"<a href=\"RealisticDatabase.html#read\">RealisticDatabase &rtrif; read</a>"},{"title":"RealisticDatabase#remove","link":"<a href=\"RealisticDatabase.html#remove\">RealisticDatabase &rtrif; remove</a>"},{"title":"RealisticDatabase#save","link":"<a href=\"RealisticDatabase.html#save\">RealisticDatabase &rtrif; save</a>"},{"title":"makeDir","link":"<a href=\"global.html#makeDir\">makeDir</a>"},{"title":"readDB","link":"<a href=\"global.html#readDB\">readDB</a>"},{"title":"validatorFunc","link":"<a href=\"global.html#validatorFunc\">validatorFunc</a>"},{"title":"writeDB","link":"<a href=\"global.html#writeDB\">writeDB</a>"}];
        var options = 
          setupSearch(list, options)
      </script>
    

    

    

    


  </body>

</html>
